SELECT GRADE_STUDENT_EPITA_EMAIL_REF,CONTACT_FIRST_NAME, CONTACT_LAST_NAME , grade_exam_type_ref, GRADE_SCORE, GRADE_COURSE_CODE_REF from (
select GRADE_STUDENT_EPITA_EMAIL_REF,CONTACT_FIRST_NAME, CONTACT_LAST_NAME, GRADE_COURSE_CODE_REF,cn.COURSE_NAME, grade_exam_type_ref, GRADE_SCORE , ss.STUDENT_POPULATION_CODE_REF, ss.STUDENT_POPULATION_YEAR_REF, ss.STUDENT_POPULATION_PERIOD_REF from GRADES
join STUDENTS as ss on GRADE_STUDENT_EPITA_EMAIL_REF = STUDENT_EPITA_EMAIL
join CONTACTS on STUDENT_CONTACT_REF = CONTACT_EMAIL
join (select COURSE_CODE, COURSE_NAME  from COURSES) as cn where cn.COURSE_CODE  = GRADE_COURSE_CODE_REF
) as ss
where ss.COURSE_NAME = '%s' and ss.STUDENT_POPULATION_CODE_REF = '%s' and ss.STUDENT_POPULATION_YEAR_REF = %u and ss.STUDENT_POPULATION_PERIOD_REF = '%s'
